<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
	<title>Antonio Vázquez Blanco</title>
	<link href="https://antoniovazquezblanco.github.io/atom.xml" rel="self"/>
	<link href="https://antoniovazquezblanco.github.io/"/>
	<updated>2014-10-20T18:33:03+02:00</updated>
	<id>https://antoniovazquezblanco.github.io</id>
	<author>
		<name>Antonio Vázquez Blanco</name>
		<email>antoniovazquezblanco@gmail.com</email>
	</author>

	
	<entry>
		<title>DIY Microscope</title>
		<link href="https://antoniovazquezblanco.github.io/blog/DIY-Microscope.html"/>
		<updated>2014-10-15T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/DIY-Microscope</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;DIY Microscope&quot; alt=&quot;diymicroscope&quot; src=&quot;/images/posts/2014-10-15-DIY_Microscope.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When soldering small devices and when inspecting circuits I sometimes need some help because I&amp;#39;m not able to see as much as I would like to. I&amp;#39;ve built a simple and cheap microscope with CCTV lenses and a webcam in 
order to make theese tasks easier.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I&amp;#39;ve reused an old Logitech QuickCam Express and bought an ABS plastic case and a &lt;a href=&quot;http://www.dx.com/p/50mm-f1-4-c-mount-cctv-lens-set-w-macro-rings-for-milc-black-144836#.VD6bN-LwyCi&quot;&gt;50mm CCTV lenses&lt;/a&gt; in wich I 
spent around 26€.&lt;/p&gt;

&lt;p&gt;After taking appart all the pieces of the webcam I disposed everything except the image sensor. Lens rear cap was perfect as holder for the image sensor.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Plastic Cage&quot; alt=&quot;plasticcage&quot; src=&quot;/images/posts/2014-10-15-Plastic_cage.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Plastic cage with rings&quot; alt=&quot;plasticcagerings&quot; src=&quot;/images/posts/2014-10-15-Cage_rings.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Image sensor&quot; alt=&quot;imgsensor&quot; src=&quot;/images/posts/2014-10-15-Image_sensor.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In my package there was two macro rings that I used to hold the lens to the plastic cage. Some glue helped to hold the rear cap to one of the rings.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Image sensor&quot; alt=&quot;imgsensor&quot; src=&quot;/images/posts/2014-10-15-Almost_done.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can see the result in the following images. The first one was made 50cm from the surface and it was difficult to focus. Resolution is not high at all but enought.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Result&quot; alt=&quot;imgsensor&quot; src=&quot;/images/posts/2014-10-15-Result.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For being able to focus in shorter distances I had to pull 3mm back the image sensor. The result was a much easier to focus image at a 30cm distance wich is a surprisingly good result compared to what I really 
expected. Here it is the image:&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Result&quot; alt=&quot;result2&quot; src=&quot;/images/posts/2014-10-15-Result_spacer.jpg&quot; /&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Ford Explorer: Pair a remote to the central locking system</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Ford-Explorer-Pair-a-remote-to-the-central-locking-system.html"/>
		<updated>2014-09-19T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Ford-Explorer-Pair-a-remote-to-the-central-locking-system</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Ford Explorer&quot; alt=&quot;fordexplorer&quot; src=&quot;/images/posts/2014-09-19-Ford_Explorer.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After my father bought a new car he stopped using his Ford Explorer. My sister now uses a car for going to work and asked me to use my old &lt;a href=&quot;https://www.google.es/search?q=Audi+80+b4+2.3e&quot;&gt;Audi 80 B4 2.3E&lt;/a&gt; so I started 
using the Explorer which I found had some problems that I will be trying to fix. I would like to share my solutions to the problems of the car in case you find them usefull.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;After some time in the garage, the keyless unlock remote battery drained. In order to replace it I opened the remote by using a plektrum (no bolts). A knife may not be a very good idea because it can damage the plastic 
case but it can also be used.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Keyless remote&quot; alt=&quot;keylessremote&quot; src=&quot;/images/posts/2014-09-19-Keyless_remote.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Battery type is CR2032 and it is normal to find them at watch workshops in Spain. You can also find them on the internet. Replacing it is very easy (beware of the polarity) and the remote can be closed.&lt;/p&gt;

&lt;p&gt;After trying I found that the remote didn&amp;#39;t work so I searched the net. It turns out that after some time without battery the remote changes it&amp;#39;s security codes and you need to teach the car to answer to the new ones. 
For pairing the remote to the car you must switch the ignition on and of 8 times and wait in the on position of the 8th attempt when you&amp;#39;ll hear the locking system close and open. Click any of the buttons of the remote 
and the car will add it to the list of known devices. This sequence should be done in less than 10 seconds for it to work.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;on-off - on-off - on-off - on-off - on-off - on-off - on-off - on - lock sounds - press the buttons&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;From now on the car will answer to the remote signals!&lt;/p&gt;

&lt;p&gt;I will need the few bucks I saved for gas because this car is really really thirsty. I also bought an ELM327 bluetooth adapter that I will use to analyze the consumption of the car among others. A friend is looking for 
a mirror that I will be changing in future posts. Please, don&amp;#39;t hesitate to ask if you have any questions and feel free to comment!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>HackThisSite: Basic 03</title>
		<link href="https://antoniovazquezblanco.github.io/blog/HackThisSite-Basic-03.html"/>
		<updated>2014-08-22T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/HackThisSite-Basic-03</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;HackThisSite logo&quot; alt=&quot;hackthissitelogo&quot; src=&quot;/images/posts/2014-08-22-HackThisSite_logo.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;HackThisSite basic challenge number three. I hope someone likes trying to solve this challenges and enjoys learning basic tricks of computer security. If you have any doubts about why things work like that just ask in 
the comments section!&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2&gt;Requisites&lt;/h2&gt;

&lt;p&gt;I understand that you know some basics about programming and that you know what PHP is from the previous challenge. In adition to that you should try to understand how the user can send information to a PHP page. HTML 
forms should be familiar to you.&lt;/p&gt;

&lt;h2&gt;Solution&lt;/h2&gt;

&lt;p&gt;You must hover the hints for them to show so not to spoil people only reading the requisites section:&lt;/p&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 1: &lt;span&gt;As always look for information in the page source...&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 2: &lt;span&gt;The form contains sensible information...&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 3: &lt;span&gt;The form points to a password.php file...&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Solution: &lt;span&gt;Append &quot;password.php&quot; to the current path and that page will return you the level password.&lt;/span&gt;&lt;/h3&gt;

&lt;h2&gt;Thoughts&lt;/h2&gt;

&lt;p&gt;I&amp;#39;ve already talked about uploading sensible information to webpages. Google is a very good friend for finding vulnerable sites with sensible information. As always you can find more about this in the &lt;a href=&quot;http://www.exploit-db.com/google-dorks/7/&quot;&gt;Google Hack 
Database&lt;/a&gt; in the &lt;a href=&quot;http://www.exploit-db.com/&quot;&gt;Exploit Database webpage&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Open wireless networks</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Open-wireless-networks.html"/>
		<updated>2014-08-07T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Open-wireless-networks</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Wifi logo&quot; alt=&quot;wifi&quot; src=&quot;/images/posts/2014-08-07-Wifi_logo.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is very common to find open wifi spots in airports, hotels, coffe shops... I understand that when you want universal internet access is tempting to use unencrypted a network but I find this very inconvinient because 
this kind of networks are very insecure.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;Open networks let users connect without password but because of their design traffic remains unencrypted letting other people view sensible information without much hasstle.&lt;br&gt;
For those who are not familiar with wireless devices, you should know that a wireless device can operate in various modes. The most common is &amp;quot;managed&amp;quot; mode, where the wireless card listens for the data that targets 
its hardware address (a network card identifier), but there are others (not always supported) like &amp;quot;monitor&amp;quot; mode where the card just shows anything that is withing physical range, whether it is targeted for that 
device or not. Monitor mode can be used to sniff others people traffic wich can be later analyzed. &lt;/p&gt;

&lt;p&gt;When I start my computer, by default, Linux puts my wireless card (wlp8s0) in managed mode:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo iwconfig
wlp8s0    IEEE 802.11abgn  ESSID:&lt;span class=&quot;s2&quot;&gt;&amp;quot;Wifi-Usos&amp;quot;&lt;/span&gt;  
          Mode:Managed  Frequency:2.437 GHz  Access Point: 00:22:B0:6F:E7:74   
          Bit &lt;span class=&quot;nv&quot;&gt;Rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48 Mb/s   Tx-Power&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;17 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link &lt;span class=&quot;nv&quot;&gt;Quality&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;29/70  Signal &lt;span class=&quot;nv&quot;&gt;level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;-81 dBm  
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:20   Missed beacon:0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For putting it into monitor mode, in my case I have to type the following commands:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ sudo ifconfig wlp8s0 down
$ sudo iwconfig wlp8s0 mode monitor 
$ sudo ifconfig wlp8s0 up
$ sudo iwconfig 
wlp8s0    IEEE 802.11abgn  Mode:Monitor  Frequency:2.437 GHz  Tx-Power=17 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:off
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Putting a card into monitor mode requires some research. Not every card supports it and not every card will enter monitor mode using previous commands. It also depends on the operative system being used (Windows, 
Linux, Mac OS...). If anyone wants to put it&amp;#39;s card into monitor mode and finds it difficult, just ask in the comments section and I will try to help as much as I can. For the followin example I will be using managed 
mode in order to avoid capturing others people traffic as I don&amp;#39;t have authorization for that.&lt;/p&gt;

&lt;p&gt;Once in the desired mode, multiple programs could be used to dump network traffic (airodump-ng, tcpdump...) but for those who don&amp;#39;t know much about the topic will find &lt;a href=&quot;http://www.wireshark.org/&quot;&gt;Wireshark&lt;/a&gt; simple to use 
(has an UI) but sometimes shows to much info. Despite the cons I think that you will find it very fun to use and easy to install (It&amp;#39;s free!).&lt;/p&gt;

&lt;p&gt;Once Wireshark is started you only have to click on the &lt;code&gt;Capture&lt;/code&gt; menu and &lt;code&gt;Interfaces...&lt;/code&gt; submenu to see the availiable devices for capturing data. I choosed &lt;code&gt;wlp8s0&lt;/code&gt; because it is my wireless network card and clicked 
start in order to start seing traffic. In the window there&amp;#39;s a main list that shows every packet captured by Wireshark. Some of the shown packets will be generated by managing protocols that are encharged of asigning 
network identifiers to every machine (IP addresses) among other... Other packets will be generated by programs trying to access internet resources as the users browsing the internet. &lt;/p&gt;

&lt;p&gt;In my case, for demonstration purposes, I opened the browser and typed &lt;code&gt;192.168.1.1&lt;/code&gt; which is the router address and it asked me for a login and because I don&amp;#39;t know the credentials to login I just used &amp;quot;asd&amp;quot; as user 
and password resulting in an access denial (Error 401). The moment I opened the router page a lot of packets were logged in Wireshark, too many for me to want to analyze them all, so I decided to filter them. In the 
top left part of the window there&amp;#39;s a field with a &amp;quot;Filter:&amp;quot; label where I wrote &lt;code&gt;http&lt;/code&gt; and hit the &lt;code&gt;enter&lt;/code&gt; key. A lot of packets disapeared and among others in the list I could see one that showed a &amp;quot;401 Unauthorized&amp;quot; 
message in the info field. After clicking on it with the right button I selected the &lt;code&gt;Follow TCP stream&lt;/code&gt; option from the list. This poped a window with the following text:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;GET / HTTP/1.1
Host: 192.168.1.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Authorization: Basic YXNkOmFzZA==
Connection: keep-alive


HTTP/1.1 401 Unauthorized
Server: micro_httpd
Cache-Control: no-cache
Date: Sat, 08 Jan 2000 05:29:54 GMT
WWW-Authenticate: Basic realm=&amp;quot;DSL Router&amp;quot;
Content-Type: text/html
Connection: close

&lt;span class=&quot;nt&quot;&gt;&amp;lt;HTML&amp;gt;&amp;lt;HEAD&amp;gt;&amp;lt;TITLE&amp;gt;&lt;/span&gt;401 Unauthorized&lt;span class=&quot;nt&quot;&gt;&amp;lt;/TITLE&amp;gt;&amp;lt;/HEAD&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;BODY&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;BGCOLOR=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;#cc9999&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;H4&amp;gt;&lt;/span&gt;401 Unauthorized&lt;span class=&quot;nt&quot;&gt;&amp;lt;/H4&amp;gt;&lt;/span&gt;
Authorization required.
&lt;span class=&quot;nt&quot;&gt;&amp;lt;HR&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;ADDRESS&amp;gt;&amp;lt;A&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;HREF=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://www.acme.com/software/micro_httpd/&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;micro_httpd&lt;span class=&quot;nt&quot;&gt;&amp;lt;/A&amp;gt;&amp;lt;/ADDRESS&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This could be divided in two parts. A request that starts with the &lt;code&gt;GET&lt;/code&gt; method and a response with the &lt;code&gt;401&lt;/code&gt; error code. For anyone familiar with the basic authentication protocol there&amp;#39;s a field in the request that 
contains a lot of information. The &lt;code&gt;Authorization: Basic YXNkOmFzZA==&lt;/code&gt; line contains the type of authentication and the user and password used to login encoded in base64. If you search Google for a base64 decoder you 
will find a lot of them online and decoding &lt;code&gt;YXNkOmFzZA==&lt;/code&gt; results in &lt;code&gt;asd:asd&lt;/code&gt; which is the user and password used.&lt;/p&gt;

&lt;p&gt;Plain text credentials is not the only problem here. You can see google query urls wich reveal the searches being done by people in the network, image urls from Google, Facebook and other pages... Even if a page 
doesn&amp;#39;t let you see the images in the revealed urls, Wireshark lets you save the responses to that url queries in files. This can be simply done by clicking on &lt;code&gt;File&lt;/code&gt; -&amp;gt; &lt;code&gt;Export objects&lt;/code&gt; -&amp;gt; &lt;code&gt;HTTP&lt;/code&gt; and selecting a 
folder. In that folder you&amp;#39;ll be able to see webpages, images and other files that had been transferred over the network.&lt;/p&gt;

&lt;p&gt;Open networks are not secure at all and they sould not be used in public spots. Alternatives are not always ideal as Wireshark can decrypt WEP or WPA traffic. In my opinion the IEEE 802.11 should create a new kind of 
network for universal access with something similar to a secret per client that should enable you to encrypt your packets in a way that other users can&amp;#39;t spy you. Maybe asymetric encryption could be used in a similar 
way as it is used in SSL. What other solutions do you think there are?&lt;/p&gt;

&lt;p&gt;I think Wireshark is a very powerfull tool that anyone can enjoy with little effort. A lot of tutorials and videos can be found around internet explaining many features that I&amp;#39;m sure you will find useful and 
interesting. Please tell me if you find any other functionality that can reveal information from open networks so that everyone can use it!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>HackThisSite: Basic 02</title>
		<link href="https://antoniovazquezblanco.github.io/blog/HackThisSite-Basic-02.html"/>
		<updated>2014-07-19T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/HackThisSite-Basic-02</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;HackThisSite logo&quot; alt=&quot;hackthissitelogo&quot; src=&quot;/images/posts/2014-07-19-HackThisSite_logo.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here you have some information about challenge basic number two. As in the first challenge here I explain what I believe the requisites are and some tips for solving the puzzle. Hope you like them.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2&gt;Requisites&lt;/h2&gt;

&lt;p&gt;For basic level 2 you should understand what a server side program is and what can be used for. An example is PHP wich is widely used all over the network. Some basic concepts about programming in any language are 
definetely important for understanding what can be happening behind the scenes in this challenge. I encourage you to investigate about the most basic concepts in programming and if you find it useful try to write some 
&amp;quot;hello world&amp;quot; like programs that include conditional statements. Beware that programming is indeed needed if you want to really get to know computer security so I really think that you should be learning the basis and 
trying to improve on your own. As always if you get stuck with any of this, feel free to ask in the comments section. &lt;/p&gt;

&lt;h2&gt;Solution&lt;/h2&gt;

&lt;p&gt;You must hover the hints for them to show so not to spoil people only reading the requisites section:&lt;/p&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 1: &lt;span&gt;Read carefully the notes on the level...&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 2: &lt;span&gt;Think about how would you do a program that achieves the same as this level...&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 3: &lt;span&gt;What the content of a file that doesn&#39;t exist can be?&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Solution: &lt;span&gt;There&#39;s no password. Just click submit with an empty password. When the program tries to read the password a null value or an empty string is returned so we have to send an empty string in order to bypass some kind of conditional statement.&lt;/span&gt;&lt;/h3&gt;

&lt;h2&gt;Thoughts&lt;/h2&gt;

&lt;p&gt;Forgetting about uploading files is very common. In worst case scenarios things like this happen and your hole system can be bypassed easely. In less harmfull situations your server side language may generate error 
messages that leak important or sensitive information that can lead to further exploitation. An example can be again found &lt;a href=&quot;https://www.google.com/search?hl=en&amp;amp;q=PHP+application+warnings+failing+%22include_path%22&amp;amp;gws_rd=ssl&quot;&gt;using 
google&lt;/a&gt; and more examples can be found in the &lt;a href=&quot;http://www.exploit-db.com/google-dorks/7/&quot;&gt;Google hacking database&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Loto24: Some thoughts</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Loto24.html"/>
		<updated>2014-07-14T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Loto24</id>
		<content type="html">&lt;p&gt;The morning of the 7th of June 2014 I&amp;#39;ve received a call and someone identified himself as part of a company called Loto24 that were offering big opportunities for gambling with the Bonoloto services. I don&amp;#39;t gamble 
and don&amp;#39;t enjoy doing it and when someone calls me with offers like this my usual answer is &amp;quot;just delete me from your phone database and bye&amp;quot;. However the man started speaking before me so for some reason I decided to 
listen for a minute (Well done man, it is not easy to get to this point with me...). He asked me about what was the actual slogan of Bonoloto and he gave me three options. I had no idea so for ending the conversation I 
picked the one I thought it was less probable to be which as the man said turned to be correct (Maybe he said yes even it was no or even the three of them were right, I just can&amp;#39;t tell...). After congratulating me he 
started to talk about his offer (while I searched in the internet for more information)...&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I think I sould clarify that this reflects my opinion and my vision of the things that happened that day.&lt;/p&gt;

&lt;h2&gt;What I understood:&lt;/h2&gt;

&lt;p&gt;As part of a very small group of 100 people (I can&amp;#39;t remember if it was me+99 or just 99 people) they were offering me the posibility of gambling 40 tickets every week during the month of July for just 60€ (I can&amp;#39;t 
remember if it was 59.99€ or 59.9€ or something similar...). They told me that the value of this tickets was around 1600€ and that if I didn&amp;#39;t win anything they would just return my money... So far &amp;quot;too&amp;quot; good... There 
must be something wrong here... How do they get a cut out of this? Why only 100 people and so much money per person? I know that advertisment can be expensive but, so much money? I need to clarify this so I start 
asking... But the man keeps pushing the offer until he thinks he sees a reasonable doubt and asks me for personal information in order to formalize the deal but I stop him.&lt;/p&gt;

&lt;h2&gt;What it turned to be:&lt;/h2&gt;

&lt;p&gt;After a lot of talking of the man and some research on the internet I started to push things by asking some uncomfortable issues.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;I&amp;#39;m part of this select group of 100 people but is there any other group more the one I&amp;#39;m about to participate in? They try to avoid the question with some other data I don&amp;#39;t care about now... Yes or no? Yes. (It is 
not advertisment because it would ruin them in any way possible... They take a cut...).&lt;/li&gt;
&lt;li&gt;What percentage of the money do you charge in case I win a prize? None. (Too clear and fast now... This is a point for the man so he tries to stick there... The trick must be somewhere else...)&lt;/li&gt;
&lt;li&gt;Am I paying for a share of the value of the tickets? I mean, I can gamble the 1600€ but if I win do I have to share my prize with the other 100 people in my &amp;quot;select&amp;quot; group? Yes... (Speaks about more data I don&amp;#39;t 
care about...)&lt;/li&gt;
&lt;li&gt;So this means I&amp;#39;m really gambling 1600€/100people = 16€ and you are charging me 60€ for that? Lots and lots of data again... In short, yes... (Asuming a lot of people would say no to this, 40€ for a couple of calls 
can be a good cut or not... They must have something else...)&lt;/li&gt;
&lt;li&gt;How long does the agreement lasts? This is for the month of July but... blah blah blah... So if I agree I wont be able to gamble in August under the same offer? You could be able because... I hear a couple of words 
that I thought would have some extra meaning for a lawyer, &amp;quot;participación abierta&amp;quot; which I don&amp;#39;t know how to translate, but that basically means that the agreement will be automatically renewed until I tell them I want 
to stop renewing it, and my notification should be at least one month in advance. This means that I will loose at least 120€ because I must tell them one month in advance...&lt;/li&gt;
&lt;li&gt;Do you think you are offering something valuable for people in an ethical way? &amp;quot;I&amp;#39;m being sincere with you when you ask me...&amp;quot; they tell me.&lt;/li&gt;
&lt;li&gt;I will be sincere with you. I&amp;#39;m not interested. Thank you very much. We both hang.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Opinion:&lt;/h2&gt;

&lt;p&gt;I cannot say that this is a fraud or a swindle because I think they stick to the law (I have no knoweldge in this area). But I can say that from my point of view this is rather unethical and tricky because although 
there might be people wich would like to enjoy this service (not me...) I think that the fair point is not to tell the truth about something when you ask about a detail, but to explain things so there are no doubts and 
surprises when someone sees a charge of 60€ the following month or when they have to share a 100€ prize between 100people to get 1€ that will allow them to avoid paying you back the month fee. 
I think that there&amp;#39;s a conflict of interest here (they want to win whether you loose or win...) but that risk is up to anyone that wants to take it. The problem is that they don&amp;#39;t explain you what the risk is (unless 
you insist) so that you pick to assume it and that is something that I refuse to be silent at.&lt;br&gt;
I personally think that there&amp;#39;s a share of blame in the person who signs the offer (because they must be responsible enought to investigate and to think by their own) but that the major problem here is both the company 
that tryes to sell the product in that way and the employee wich chooses to do it for his own knowing that may cause trouble and pain to other people by not telling everything.
I really hope this kind of attitude changes and I would really like that law changes to protect us from this. I can imagine a law that forces companies to record phone sellings for analisys in case of client 
complaints...&lt;/p&gt;

&lt;h2&gt;Other people opinions:&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.listaspam.com/busca.php?Telefono=971016112&quot;&gt;http://www.listaspam.com/busca.php?Telefono=971016112&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://loto24.info/&quot;&gt;http://loto24.info/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jservera.com/index.php/es-ES/inicio/criminologia/533-euroloto-24-y-sus-practicaspoco-eticas#sthash.cdQ1J2hM.dpbs&quot;&gt;http://jservera.com/index.php/es-ES/inicio/criminologia/533-euroloto-24-y-sus-practicaspoco-eticas#sthash.cdQ1J2hM.dpbs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jservera.com/index.php/es-ES/inicio/criminologia/94-hablando-de-estafas-el-timo-del-euromillon#sthash.maIYzi82.SZ2jZGSh.dpbs&quot;&gt;http://jservera.com/index.php/es-ES/inicio/criminologia/94-hablando-de-estafas-el-timo-del-euromillon#sthash.maIYzi82.SZ2jZGSh.dpbs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://diariodepensador.es/2011/04/euroloto24-te-regala-millones/&quot;&gt;http://diariodepensador.es/2011/04/euroloto24-te-regala-millones/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://lacomunidad.elpais.com/xelextepv/2011/9/11/extrano-concurso-telefono-apostar-euromillones&quot;&gt;http://lacomunidad.elpais.com/xelextepv/2011/9/11/extrano-concurso-telefono-apostar-euromillones&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;What do you think?&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>HackThisSite: Basic 01</title>
		<link href="https://antoniovazquezblanco.github.io/blog/HackThisSite-Basic-01.html"/>
		<updated>2014-07-04T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/HackThisSite-Basic-01</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;HackThisSite logo&quot; alt=&quot;hackthissitelogo&quot; src=&quot;/images/posts/2014-07-04-HackThisSite_logo.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I found &lt;a href=&quot;https://www.hackthissite.org/&quot;&gt;hackthissite.org&lt;/a&gt; quite long time ago when I was learning some basics of computer security and I really liked it. It is meant to reinforce theoretical knowledge with some 
practice. It consists on a bunch of challenges that should be solved progressively.&lt;/p&gt;

&lt;p&gt;Here I will try to explain some of the solutions I gave to the challenges for fun. My aim is to share the thoughts that lead me to the result as well as hearing your opinion about my procedures.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;In the site you can find challenges about very different topic but I will start by trying to solve the &amp;quot;Basic&amp;quot; section.&lt;/p&gt;

&lt;h2&gt;Requisites&lt;/h2&gt;

&lt;p&gt;For basic level 1 you must know the basics about html. It would be nice if you were able to do some of the basic stuff you need to make a webpage. I encourage you to create some simple examples that may include using 
images listing some elements and linking to other webpages if you don&amp;#39;t know how to do it. Google is your friend for that but if you feel it is too much for you feel free to ask.&lt;/p&gt;

&lt;h2&gt;Solution&lt;/h2&gt;

&lt;p&gt;You must hover the hints for them to show so not to spoil people only reading the requisites section:&lt;/p&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 1: &lt;span&gt;There&#39;s not much you can do. Try to understand how things work.&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 2: &lt;span&gt;For understanding how things work you must look at the html code.&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Hint 3: &lt;span&gt;Look up in google what an html comment is...&lt;/span&gt;&lt;/h3&gt;

&lt;h3 class=&quot;spoiler&quot;&gt;Solution: &lt;span&gt;In the html code there&#39;s a comment saying &quot;pasword is...&quot;&lt;/span&gt;&lt;/h3&gt;

&lt;h2&gt;Thoughts&lt;/h2&gt;

&lt;p&gt;This may seem ridiculous but I think it is a good challenge because it is very simple. It just helps the ones that have no idea of information security at all while showing something that is more common that anybody 
should think, plain text passwords. You may be surprised of how many people do this: &lt;a href=&quot;http://plaintextoffenders.com/&quot;&gt;http://plaintextoffenders.com/&lt;/a&gt;. Not only in emails but in forms among others.
Quite long ago, Microsoft Frontpage used to store a lot of plain text information in the root of the webpages made with this tool. This can be very delicated because if a tool widely used stores plain text information 
we can use google to search for vulnerable webpages. One example is &lt;a href=&quot;https://www.google.com/search?q=xamppdirpasswd.txt%20filetype:txt&amp;amp;gws_rd=ssl&quot;&gt;XAMPP directory passwords&lt;/a&gt;. More hacks about public information can be 
found in &lt;a href=&quot;http://www.exploit-db.com/google-dorks/&quot;&gt;exploit database&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Some HTML/CSS stuff I don't like: Translations</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Some-HTML-CSS-stuff-I-dont-like-translations.html"/>
		<updated>2014-06-26T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Some-HTML-CSS-stuff-I-dont-like-translations</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;HTML5, CSS3 and JS logos&quot; alt=&quot;htmlcssjslogo&quot; src=&quot;/images/posts/2014-06-26-HTML_CSS_JS_logo.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I never liked HTML or CSS too much. I have to say that althought they were easy for me to get started with them, I always found tricky to get some things well done. I have to say that HTML 5 standard did improve a lot 
of aspects of this language but I see this technology too far from where it should be. Althought it has evolved there has been no interest in fixing some of the most basic issues of the standard among, in some cases, 
no interest in site maintenance to keep up to date with the latest changes. I&amp;#39;m thinking in an example while I write my opinion, it is translations.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;Although multilanguage webpages are very important in some cases there&amp;#39;s no standard way of translating webpages. I can&amp;#39;t imagine why this topic has never been talked so seriously it doesn&amp;#39;t is part of html standard.
If you want a page to be in various languages you must translate it via Javascript (Implies loading more content than needed and charging the user side computation), either duplicate the page (Maintainig repeated 
content), either use server side languages that you may not want or need. In my opinion none of this is ideal and it could be better with very little effort.&lt;/p&gt;

&lt;p&gt;A lot of alternatives have been showing up in order to fill this gap. Adobe has an Air framework for localization, Microsoft is pushing its methods for html based apps, numerous jQuery plugins are availiable for 
acomplishing this task, node.js, django, php... Everyone is looking fordward a system that can be widely used but I&amp;#39;m personally not very pleased with none of them.&lt;/p&gt;

&lt;p&gt;Knowing that actual browsers must be able to parse XML similar language and that a great majority of them are able to parse and run Javascript I think that being able to parse strings from an XML or JSON from a file is 
not so hard to implement. I don&amp;#39;t really care about the format of storing strings (Even CSS like format could be ok). I am thinking of a tag that includes a localization file as CSS is included:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.es.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;es&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.en.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;en&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A second thing is needed for this to work, a way to relate an id to a string inside HTML. A new property should be enought for this to be working:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.es.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;es&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.en.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;en&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;content&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This way the browser would be responsible for parsing the correct localization file based on the user preferences and populate the content of the tags that contain the translation property. This enables the browser to 
optimize the translation loading code instead of being loaded by Javascript for example and to reduce the amount of data transferred throught the network by only loading the desired localization file.&lt;/p&gt;

&lt;p&gt;I can think of a major con to my mehtod that is related with nested tags:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.es.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;es&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.en.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;en&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt; 
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;something&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;something_else&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://google.com/&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the exposed case the &lt;code&gt;a&lt;/code&gt; tag cannot be between &lt;code&gt;p&lt;/code&gt; text. Either it is before either after. That forces us to change the structure of the page to something similar to the following and to fix the appearance 
with css.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.es.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;es&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;index.en.lang&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;localization&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loc=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;en&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/json&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;something_pre&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;something_else&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://google.com/&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;textid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;something_post&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I don&amp;#39;t know what your experience with HTML/CSS is but for me this is kind of a big fail.&lt;/p&gt;

&lt;p&gt;As I&amp;#39;m not to happy with this standard I think I will be writing about my thoughts on these languages from time to time. I would like to hear your oppinion in this topic because you will probably have much more 
experience than me in this area.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Binary firmware analysis</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Binary-firmware-analysis.html"/>
		<updated>2014-06-22T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Binary-firmware-analysis</id>
		<content type="html">&lt;p&gt;When trying to find exploits or vulnerabilities in embedded devices, any information is very useful.&lt;/p&gt;

&lt;p&gt;Firmware analysis can be a good starting point as there&amp;#39;s no need to have physical access to a device in order to investigate and there&amp;#39;s no need to buy one as long as the manufacturer let you download updates from their website.&lt;/p&gt;

&lt;p&gt;In the following examples I&amp;#39;m going to use a firmware from TP-LINK for &lt;a href=&quot;http://www.tp-link.com/ar/support/download/?model=TL-WR841N&amp;amp;version=V8#tbl_j&quot;&gt;TL-WR841N v8 (Soft. version: 3.13.33)&lt;/a&gt;.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;HexEdit&quot; alt=&quot;hexeditor&quot; src=&quot;/images/posts/2014-06-22-HexEdit.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hex editors can be very useful for some things but when you are trying to search for some file signatures and you have a list of over 50 of them, they become tedious and repetitive so in the past I started using the 
&amp;quot;strings&amp;quot; command in order to find usual signatures like &amp;quot;sqfs&amp;quot; or its variants for squash filesystems. This enabled me to automate signature finding with bash scripts very easely.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings WR841N_v8_en_3.13.33.bin &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep sq
sq&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;q
&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;qey
&lt;span class=&quot;p&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;wsq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;F
sqVZ
Tsq0
hsqs
sqb&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;wa
4sqJ
7sq&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
HDsq1&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
sq@&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
+&lt;span class=&quot;err&quot;&gt;&amp;quot;&lt;/span&gt;Osq
Ksq&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
busq
nGsq
sqWb
sq6X
&lt;span class=&quot;p&quot;&gt;&amp;amp;&lt;/span&gt;&amp;gt;sq
C5besq
msqFm
p7sq
s-sq
Ofsq
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the previous example &amp;quot;hsqs&amp;quot; is a variant of a squashfs. Although this works, there are tools that make this job very easy. I personally use &lt;a href=&quot;http://binwalk.org/&quot;&gt;binwalk&lt;/a&gt; in order to search for file signatures in 
binary files.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;binwalk WR841N_v8_en_3.13.33.bin

DECIMAL    HEX        DESCRIPTION
-------------------------------------------------------------------------------------------------------------------
0          0x0        TP-Link firmware header, firmware version: 3.13.33, image version: &lt;span class=&quot;s2&quot;&gt;&amp;quot;ver. 1.0&amp;quot;&lt;/span&gt;, product ID: 0x8410008, product version: 1, kernel load address: 0x80002000, kernel entry point: 0x801AA240, kernel 
offset: 512, kernel length: 813084, rootfs offset: 1048576, rootfs length: 2883584, bootloader offset: 0, bootloader length: 49140
13392      0x3450     U-Boot boot loader reference
14728      0x3988     uImage header, header size: 64 bytes, header CRC: 0xBA7F2047, created: Mon May  6 07:20:35 2013, image size: 34860 bytes, Data Address: 0x80010000, Entry Point: 0x80010000, data CRC: 0x263C3839, 
OS: Linux, CPU: MIPS, image &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: Firmware Image, compression &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: lzma, image name: &lt;span class=&quot;s2&quot;&gt;&amp;quot;u-boot image&amp;quot;&lt;/span&gt;
14760      0x39A8     U-Boot boot loader reference
14792      0x39C8     LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 99104 bytes
131584     0x20200    TP-Link firmware header, firmware version: 3.13.33, image version: &lt;span class=&quot;s2&quot;&gt;&amp;quot;ver. 1.0&amp;quot;&lt;/span&gt;, product ID: 0x8410008, product version: 1, kernel load address: 0x80002000, kernel entry point: 0x801AA240, kernel 
offset: 512, kernel length: 813084, rootfs offset: 1048576, rootfs length: 2883584, bootloader offset: 0, bootloader length: 0
132096     0x20400    LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 2317284 bytes
1180160    0x120200   Squashfs filesystem, little endian, version 4.0, compression: lzma, size: 2652846 bytes,  537 inodes, blocksize: 131072 bytes, created: Mon May  6 07:32:12 2013
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can see binwalk detects a lot of useful signatures and can also decompress them by using the parameter &amp;quot;-e&amp;quot;.&lt;/p&gt;

&lt;p&gt;And after extracting an embedded Linux directory tree comes up.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ls
filesystem  filesystem.sqfs  kernel  uboot
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;filesystem/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ls *
linuxrc

bin:
busybox  cat  chmod  date  df  &lt;span class=&quot;nb&quot;&gt;echo  false  &lt;/span&gt;hostname  iptables-xml  &lt;span class=&quot;nb&quot;&gt;kill  &lt;/span&gt;login  ls  mount  msh  ping  ps  rm  sh  &lt;span class=&quot;nb&quot;&gt;true  &lt;/span&gt;umount

dev:
pts

etc:
ath  fstab  group  host.conf  inittab  issue  lld2d.conf  nsswitch.conf  passwd  ppp  rc.d  resolv.conf  securetty  services  shadow  wlan  wpa2  wr941n.ico

lib:
ld-uClibc-0.9.30.so  libdl-0.9.30.so  libip4tc.la        libip6tc.so        libiptc.so.0      libmsglog.so      libnsl.so.0           libresolv.so     libuClibc-0.9.30.so  libxtables.la        pkgconfig
ld-uClibc.so.0       libdl.so.0       libip4tc.so        libip6tc.so.0      libiptc.so.0.0.0  libm.so           libpthread-0.9.30.so  libresolv.so.0   libutil-0.9.30.so    libxtables.so
libcrypt-0.9.30.so   libexec          libip4tc.so.0      libip6tc.so.0.0.0  libiw.so          libm.so.0         libpthread.so         librt-0.9.30.so  libutil.so.0         libxtables.so.2
libcrypt.so.0        libgcc_s.so      libip4tc.so.0.0.0  libiptc.la         libiw.so.29       libnsl-0.9.30.so  libpthread.so.0       librt.so         libwpa_common.so     libxtables.so.2.1.0
libc.so.0            libgcc_s.so.1    libip6tc.la        libiptc.so         libm-0.9.30.so    libnsl.so         libresolv-0.9.30.so   librt.so.0       libwpa_ctrl.so       modules

mnt:

proc:

root:

sbin:
brctl  hostapd   init    iptables        iptables-restore  iwconfig  iwpriv  logread  reboot  route    tc      vconfig     wpa_supplicant
getty  ifconfig  insmod  iptables-multi  iptables-save     iwlist    klogd   lsmod    rmmod   syslogd  udhcpc  wlanconfig

sys:

tmp:

usr:
arp  bin  net_ioctl  sbin

var:
run

web:
dynaform  frames  &lt;span class=&quot;nb&quot;&gt;help  &lt;/span&gt;images  localiztion  oem  userRpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We now have access to files like /etc/passwd for password cracking or web files for further investigation among others. Many times the default configuration is stored in the filesystem and can reveal potential breachs 
due to misconfiguration. &lt;/p&gt;

&lt;p&gt;In following series I&amp;#39;ll try to explain some ideas that let me discover some bugs in the past. I will try to cover some basics when analysing embedded Linux firmwares.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>New InsydeH2O BIOS update format</title>
		<link href="https://antoniovazquezblanco.github.io/blog/New-InsydeH2O-BIOS-update-format.html"/>
		<updated>2014-06-04T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/New-InsydeH2O-BIOS-update-format</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;InsydeH2O logo&quot; alt=&quot;insydeh2o&quot; src=&quot;/images/posts/2014-06-04-Insyde_logo.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Some time ago I bought an Alienware M14xR2 as my last laptop broke down. Lately, Alienware published an update for my BIOS that I can&amp;#39;t burn in my computer because I only use Archlinux. By googling a bit I quickly 
found a tool for burning the BIOS in a DOS command line but I would need to have a look to the &lt;a href=&quot;http://www.dell.com/support/drivers/es/es/esdhs1/DriverDetails/Product/alienware-m14x-r2?driverId=6CVT8&amp;amp;osCode=W764&amp;amp;fileId=3210572008&amp;amp;languageCode=es&amp;amp;categoryId=BI&quot;&gt;update package&lt;/a&gt;.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;Just by executing the update file in a virtual machine in windows I soon figured out it was a self extracting package. I just searched %TEMP% files for the extracted version.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Self extractor&quot; alt=&quot;selfextractor&quot; src=&quot;/images/posts/2014-06-04-Self_extractor.png&quot; /&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file *
Ding.wav:         RIFF &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;little-endian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; data, WAVE audio, Microsoft PCM, 16 bit, stereo 44100 Hz
FlsHookDll.dll:   PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DLL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
FlsHook.exe:      PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
FWUpdLcl.exe:     PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;console&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
InsydeFlash.exe:  PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
iscflash.dll:     PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DLL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
iscflash.sys:     PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;native&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
iscflashx64.sys:  PE32+ executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;native&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x86-64, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
isflashWin.bin:   MS-DOS executable
platform.ini:     ASCII text, with CRLF line terminators
platforms.ini:    ASCII text, with CRLF, CR line terminators
xerces-c_2_7.dll: PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DLL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ding.wav is just audio. I suppose it is played when flash is finished.
Just by reading the header of the ini files we can guess they are configuration files for the flasher utility. The format is self explained in comments. In line 61 I found that the file I wanted for flashing was 
isflashWin.bin but after a fast attempt with FreeDOS and the tool I mentioned before I realised that the format was not FD as it should so I googled a bit more. As it turns out, Insyde has released a new update file 
format and as it seems it isn&amp;#39;t documented.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings isflashWin.bin
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
!MV/VZ
.text
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;_TEXT_REI
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;_TEXT_PR
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;.rdata
@.data
.reloc
fRfPf
fXfZ
fRfPf
fXfZ
ud9F
u_&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;^
9F t:9F
9F t
y&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;SVWh
fPf3
3k4j6t7x7&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;7
:R&amp;lt;V&amp;lt;
&lt;span class=&quot;nv&quot;&gt;$BID01433&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_INI_IMG&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;This file is InsydeFlash utility configuration file
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;CommonFlash&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SwitchString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PJMDEN CPVER:&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; FHRST
&lt;span class=&quot;nv&quot;&gt;ErrorMsg00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;No error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg01&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;AC detect error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;DC detect error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg03&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;DC gas gauge under 10%!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg04&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;BIOS version compare error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Model name compare error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Not support this version of Flash Common Interface!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Show BIOS version string length more &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;xx bytes.
&lt;span class=&quot;nv&quot;&gt;ErrorMsg12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Show model name string length more &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;xx bytes.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Inside the file I found a section that is exactly the same as the configuration file and it is preceded by a string quite suspicious.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings isflashWin.bin &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep &lt;span class=&quot;s2&quot;&gt;&amp;quot;\$_IFLASH&amp;quot;&lt;/span&gt;
5&lt;span class=&quot;nv&quot;&gt;$_IFLASH_DRV_IMG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_BIOSIMG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_INI_IMG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_EC_IMG_&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I think these headers separate sections of the file as they are all 16 characters long. By having a look inside Hexedit I found that there is a padding of 8 bytes between the last character and some famous file magic 
numbers. I&amp;#39;ve done a simple python script (filesplitter) for splitting this kind of files and continue the analysis.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;argparse&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_DRV_IMG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_BIOSIMG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_INI_IMG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_EC_IMG_&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argparse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArgumentParser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Split Insyde H2O firmware files.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_argument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;-f&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;--file&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;filename&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;File to be processed.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metavar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parse_args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;makedirs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/one&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/two&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/three&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/four&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/five&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./filesplitter -f isflashWin.bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;isflashWin/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file *
five:  data
four:  ASCII text, with CRLF line terminators
one:   MS-DOS executable
three: Intel serial flash &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;PCH ROM
two:   MS-DOS executable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Part number four is clearly the configuration file. If you are trying to tweak parameters in platform.ini note that it wont work, but if you modify this part of the binary file it will. It seems that Insyde is now 
using the platform.ini only to point to the update file (isflashWin.bin) and then the utility just parses the configuration from there.
I had no success in running one and two. I&amp;#39;ve tried FreeDOS and Windows 98 in DOS mode which should have support for MZ executables but in the best case I got no output and in the worse some memory address exceptions.
I found that number three is related to a utility called &lt;a href=&quot;http://flashrom.org/Flashrom&quot;&gt;Flashrom&lt;/a&gt; but I don&amp;#39;t have much time to investigate. Maybe some readers can point me in the right direction.
After having a look to five in Hexedit I think it can be a BIOS image although I don&amp;#39;t really know about this topic.&lt;/p&gt;

&lt;p&gt;Although I could not flash my BIOS I could find some little information about this new format and I also found that MZ executable signatures weren&amp;#39;t in the binary analysis tool I use (&lt;a href=&quot;http://binwalk.com/&quot;&gt;binwalk&lt;/a&gt;). 
The latest version of binwalk now looks for MZ executables.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Multiple security flaws in Comtrend router</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Multiple-security-flaws-in-Comtrend-router.html"/>
		<updated>2014-05-20T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Multiple-security-flaws-in-Comtrend-router</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Conceptronic C54APM access point&quot; alt=&quot;c54apmaccesspoint&quot; src=&quot;/images/posts/2014-05-20-Comtrend_C54APM.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Last summer I&amp;#39;ve been playing with an old access point I found among my unused devices. Although this is far away from being a top selling device I decided to investigate a bit in order to find security flaws on it.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I&amp;#39;ve downloaded the latest binary firmware for it and analysed it. This along some other information retrieved by the UART port inside it lead to a discovery of security flaws in the web interface.&lt;/p&gt;

&lt;p&gt;Future posts will explain how I was able to interface the UART port and some basis of firmware analisys. I hope you will find them interesting.&lt;/p&gt;

&lt;p&gt;More information can be found in the following links:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/docs/advisories/Advisory_C54APM_Multiple.pdf&quot;&gt;Advisory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1405&quot;&gt;CVE-2014-1405&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1406&quot;&gt;CVE-2014-1406&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1407&quot;&gt;CVE-2014-1407&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1408&quot;&gt;CVE-2014-1408&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101916&quot;&gt;OSVDB 101916&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101917&quot;&gt;OSVDB 101917&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101918&quot;&gt;OSVDB 101918&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101919&quot;&gt;OSVDB 101919&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101920&quot;&gt;OSVDB 101920&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101921&quot;&gt;OSVDB 101921&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
	</entry>
	
	<entry>
		<title>Security flaw in RomPager webserver</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Security-flaw-in-RomPager-webserver.html"/>
		<updated>2014-05-18T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Security-flaw-in-RomPager-webserver</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Allegro software&quot; alt=&quot;allegrosoftware&quot; src=&quot;/images/posts/2014-05-18-Allegro_software.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RomPager is a widely used embedded webserver. Playing around with an quite old but very widely used (or at least in Spain) ZyXEL P-660HW-D1 I could find an small bug in this software that leads to XSS and URL redirection.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I&amp;#39;ve reported to &lt;a href=&quot;http://cert.inteco.es/&quot;&gt;INTECO-CERT&lt;/a&gt; and I was told that this was already fixed in newer versions of the software because this had been seen previously in other devices. Although this was already 
discovered it had no CVE identifier so I requested one to MITRE.&lt;/p&gt;

&lt;p&gt;Further information about affected devices and how to exploit the issue can be found in the following links:  &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/docs/advisories/Advisory_RomPagerXSS.pdf&quot;&gt;Advisory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://osvdb.org/show/osvdb/99694&quot;&gt;OSVDB 99694&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://osvdb.org/show/osvdb/99695&quot;&gt;OSVDB 99695&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://cve.mitre.org/cgi-bin/cvename.cgi?name=2013-6786&quot;&gt;CVE 2013-6786&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
	</entry>
	
	<entry>
		<title>Hello world</title>
		<link href="https://antoniovazquezblanco.github.io/blog/Hello-world.html"/>
		<updated>2014-04-18T00:00:00+02:00</updated>
		<id>https://antoniovazquezblanco.github.io/blog/Hello-world</id>
		<content type="html">&lt;p&gt;&lt;img class=&quot;img img-rounded img-responsive center-block&quot; title=&quot;Antonio Vázquez Blanco&quot; alt=&quot;antoniovazquezblanco&quot; src=&quot;/images/posts/2014-04-18-Myself.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I&amp;#39;m an engineering undergraduate born in a &lt;a href=&quot;https://www.google.com/maps/place/Chantada&quot;&gt;small town called Chantada&lt;/a&gt;, that likes electronics and computer and if you ask me, I&amp;#39;m specially interested in the security area 
and in robotics.  &lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I would like to use this blog to share some of my experiences and specially the knowledge that I found difficult to locate on the net or that really helped me getting introduced into particular topics like embeded 
device security.  &lt;/p&gt;

&lt;p&gt;I think you will find usefull some of my projects and interests and I hope you can learn from my experience the same way I expect learning from your opinions and comments. I would like to see a lot of feedback and/or 
any questions you think I might be able to solve in my mailbox (&lt;a href=&quot;mailto:antoniovazquezblanco@gmail.com&quot;&gt;antoniovazquezblanco@gmail.com&lt;/a&gt;) or in comments &lt;span style=&quot;text-decoration:line-through&quot;&gt;(not implemented yet in this blog...)&lt;/span&gt;.&lt;/p&gt;
</content>
	</entry>
	
</feed>
