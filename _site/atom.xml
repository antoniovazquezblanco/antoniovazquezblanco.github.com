<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
	<title>Antonio Vázquez Blanco</title>
	<link href="http://antoniovazquezblanco.github.io//atom.xml" rel="self"/>
	<link href="http://antoniovazquezblanco.github.io//"/>
	<updated>2014-06-22T13:39:48+02:00</updated>
	<id>http://antoniovazquezblanco.github.io/</id>
	<author>
		<name>Antonio Vázquez Blanco</name>
		<email>antoniovazquezblanco@gmail.com</email>
	</author>

	
	<entry>
		<title>Binary firmware analysis</title>
		<link href="http://antoniovazquezblanco.github.io//2014/06/22/Binary-firmware-analysis.html"/>
		<updated>2014-06-22T00:00:00+02:00</updated>
		<id>http://antoniovazquezblanco.github.io//2014/06/22/Binary-firmware-analysis</id>
		<content type="html">&lt;p&gt;When trying to find exploits or vulnerabilities in embedded devices, any information is very useful.&lt;/p&gt;

&lt;p&gt;Firmware analysis can be a good starting point as there&amp;#39;s no need to have physical access to a device in order to investigate and there&amp;#39;s no need to buy one as long as the manufacturer let you download updates from their website.&lt;/p&gt;

&lt;p&gt;In the following examples I&amp;#39;m going to use a firmware from TP-LINK for &lt;a href=&quot;http://www.tp-link.com/ar/support/download/?model=TL-WR841N&amp;amp;version=V8#tbl_j&quot;&gt;TL-WR841N v8 (Soft. version: 3.13.33)&lt;/a&gt;.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/2014-06-22-HexEdit.png&quot; alt=&quot;hexeditor&quot; title=&quot;HexEdit&quot;&gt;&lt;/p&gt;

&lt;p&gt;Hex editors can be very useful for some things but when you are trying to search for some file signatures and you have a list of over 50 of them, they become tedious and repetitive so in the past I started using the 
&amp;quot;strings&amp;quot; command in order to find usual signatures like &amp;quot;sqfs&amp;quot; or its variants for squash filesystems. This enabled me to automate signature finding with bash scripts very easely.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings WR841N_v8_en_3.13.33.bin &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep sq
sq&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;q
&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;qey
&lt;span class=&quot;p&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;wsq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;F
sqVZ
Tsq0
hsqs
sqb&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;wa
4sqJ
7sq&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
HDsq1&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
sq@&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
+&lt;span class=&quot;err&quot;&gt;&amp;quot;&lt;/span&gt;Osq
Ksq&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
busq
nGsq
sqWb
sq6X
&lt;span class=&quot;p&quot;&gt;&amp;amp;&lt;/span&gt;&amp;gt;sq
C5besq
msqFm
p7sq
s-sq
Ofsq
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the previous example &amp;quot;hsqs&amp;quot; is a variant of a squashfs. Although this works, there are tools that make this job very easy. I personally use &lt;a href=&quot;http://binwalk.org/&quot;&gt;binwalk&lt;/a&gt; in order to search for file signatures in 
binary files.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;binwalk WR841N_v8_en_3.13.33.bin

DECIMAL    HEX        DESCRIPTION
-------------------------------------------------------------------------------------------------------------------
0          0x0        TP-Link firmware header, firmware version: 3.13.33, image version: &lt;span class=&quot;s2&quot;&gt;&amp;quot;ver. 1.0&amp;quot;&lt;/span&gt;, product ID: 0x8410008, product version: 1, kernel load address: 0x80002000, kernel entry point: 0x801AA240, kernel 
offset: 512, kernel length: 813084, rootfs offset: 1048576, rootfs length: 2883584, bootloader offset: 0, bootloader length: 49140
13392      0x3450     U-Boot boot loader reference
14728      0x3988     uImage header, header size: 64 bytes, header CRC: 0xBA7F2047, created: Mon May  6 07:20:35 2013, image size: 34860 bytes, Data Address: 0x80010000, Entry Point: 0x80010000, data CRC: 0x263C3839, 
OS: Linux, CPU: MIPS, image &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: Firmware Image, compression &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: lzma, image name: &lt;span class=&quot;s2&quot;&gt;&amp;quot;u-boot image&amp;quot;&lt;/span&gt;
14760      0x39A8     U-Boot boot loader reference
14792      0x39C8     LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 99104 bytes
131584     0x20200    TP-Link firmware header, firmware version: 3.13.33, image version: &lt;span class=&quot;s2&quot;&gt;&amp;quot;ver. 1.0&amp;quot;&lt;/span&gt;, product ID: 0x8410008, product version: 1, kernel load address: 0x80002000, kernel entry point: 0x801AA240, kernel 
offset: 512, kernel length: 813084, rootfs offset: 1048576, rootfs length: 2883584, bootloader offset: 0, bootloader length: 0
132096     0x20400    LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 2317284 bytes
1180160    0x120200   Squashfs filesystem, little endian, version 4.0, compression: lzma, size: 2652846 bytes,  537 inodes, blocksize: 131072 bytes, created: Mon May  6 07:32:12 2013
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can see binwalk detects a lot of useful signatures and can also decompress them by using the parameter &amp;quot;-e&amp;quot;.&lt;/p&gt;

&lt;p&gt;And after extracting an embedded Linux directory tree comes up.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ls
filesystem  filesystem.sqfs  kernel  uboot
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;filesystem/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ls *
linuxrc

bin:
busybox  cat  chmod  date  df  &lt;span class=&quot;nb&quot;&gt;echo  false  &lt;/span&gt;hostname  iptables-xml  &lt;span class=&quot;nb&quot;&gt;kill  &lt;/span&gt;login  ls  mount  msh  ping  ps  rm  sh  &lt;span class=&quot;nb&quot;&gt;true  &lt;/span&gt;umount

dev:
pts

etc:
ath  fstab  group  host.conf  inittab  issue  lld2d.conf  nsswitch.conf  passwd  ppp  rc.d  resolv.conf  securetty  services  shadow  wlan  wpa2  wr941n.ico

lib:
ld-uClibc-0.9.30.so  libdl-0.9.30.so  libip4tc.la        libip6tc.so        libiptc.so.0      libmsglog.so      libnsl.so.0           libresolv.so     libuClibc-0.9.30.so  libxtables.la        pkgconfig
ld-uClibc.so.0       libdl.so.0       libip4tc.so        libip6tc.so.0      libiptc.so.0.0.0  libm.so           libpthread-0.9.30.so  libresolv.so.0   libutil-0.9.30.so    libxtables.so
libcrypt-0.9.30.so   libexec          libip4tc.so.0      libip6tc.so.0.0.0  libiw.so          libm.so.0         libpthread.so         librt-0.9.30.so  libutil.so.0         libxtables.so.2
libcrypt.so.0        libgcc_s.so      libip4tc.so.0.0.0  libiptc.la         libiw.so.29       libnsl-0.9.30.so  libpthread.so.0       librt.so         libwpa_common.so     libxtables.so.2.1.0
libc.so.0            libgcc_s.so.1    libip6tc.la        libiptc.so         libm-0.9.30.so    libnsl.so         libresolv-0.9.30.so   librt.so.0       libwpa_ctrl.so       modules

mnt:

proc:

root:

sbin:
brctl  hostapd   init    iptables        iptables-restore  iwconfig  iwpriv  logread  reboot  route    tc      vconfig     wpa_supplicant
getty  ifconfig  insmod  iptables-multi  iptables-save     iwlist    klogd   lsmod    rmmod   syslogd  udhcpc  wlanconfig

sys:

tmp:

usr:
arp  bin  net_ioctl  sbin

var:
run

web:
dynaform  frames  &lt;span class=&quot;nb&quot;&gt;help  &lt;/span&gt;images  localiztion  oem  userRpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We now have access to files like /etc/passwd for password cracking or web files for further investigation among others. Many times the default configuration is stored in the filesystem and can reveal potential breachs 
due to misconfiguration. &lt;/p&gt;

&lt;p&gt;In following series I&amp;#39;ll try to explain some ideas that let me discover some bugs in the past. I will try to cover some basics when analysing embedded Linux firmwares.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>New InsydeH2O BIOS update format</title>
		<link href="http://antoniovazquezblanco.github.io//2014/06/04/New-InsydeH2O-BIOS-update-format.html"/>
		<updated>2014-06-04T00:00:00+02:00</updated>
		<id>http://antoniovazquezblanco.github.io//2014/06/04/New-InsydeH2O-BIOS-update-format</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;/images/posts/2014-06-04-Insyde_logo.jpg&quot; alt=&quot;insydeh2o&quot; title=&quot;InsydeH2O logo&quot;&gt;&lt;/p&gt;

&lt;p&gt;Some time ago I bought an Alienware M14xR2 as my last laptop broke down. Lately, Alienware published an update for my BIOS that I can&amp;#39;t burn in my computer because I only use Archlinux. By googling a bit I quickly 
found a tool for burning the BIOS in a DOS command line but I would need to have a look to the &lt;a href=&quot;http://www.dell.com/support/drivers/es/es/esdhs1/DriverDetails/Product/alienware-m14x-r2?driverId=6CVT8&amp;amp;osCode=W764&amp;amp;fileId=3210572008&amp;amp;languageCode=es&amp;amp;categoryId=BI&quot;&gt;update package&lt;/a&gt;.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;Just by executing the update file in a virtual machine in windows I soon figured out it was a self extracting package. I just searched %TEMP% files for the extracted version.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/2014-06-04-Self_extractor.png&quot; alt=&quot;selfextractor&quot; title=&quot;Self extractor...&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file *
Ding.wav:         RIFF &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;little-endian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; data, WAVE audio, Microsoft PCM, 16 bit, stereo 44100 Hz
FlsHookDll.dll:   PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DLL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
FlsHook.exe:      PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
FWUpdLcl.exe:     PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;console&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
InsydeFlash.exe:  PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
iscflash.dll:     PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DLL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
iscflash.sys:     PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;native&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
iscflashx64.sys:  PE32+ executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;native&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x86-64, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
isflashWin.bin:   MS-DOS executable
platform.ini:     ASCII text, with CRLF line terminators
platforms.ini:    ASCII text, with CRLF, CR line terminators
xerces-c_2_7.dll: PE32 executable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DLL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GUI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Intel 80386, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;MS Windows
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ding.wav is just audio. I suppose it is played when flash is finished.
Just by reading the header of the ini files we can guess they are configuration files for the flasher utility. The format is self explained in comments. In line 61 I found that the file I wanted for flashing was 
isflashWin.bin but after a fast attempt with FreeDOS and the tool I mentioned before I realised that the format was not FD as it should so I googled a bit more. As it turns out, Insyde has released a new update file 
format and as it seems it isn&amp;#39;t documented.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings isflashWin.bin
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
!MV/VZ
.text
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;_TEXT_REI
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;_TEXT_PR
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;.rdata
@.data
.reloc
fRfPf
fXfZ
fRfPf
fXfZ
ud9F
u_&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;^
9F t:9F
9F t
y&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;SVWh
fPf3
3k4j6t7x7&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;7
:R&amp;lt;V&amp;lt;
&lt;span class=&quot;nv&quot;&gt;$BID01433&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_INI_IMG&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;This file is InsydeFlash utility configuration file
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;CommonFlash&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SwitchString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PJMDEN CPVER:&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; FHRST
&lt;span class=&quot;nv&quot;&gt;ErrorMsg00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;No error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg01&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;AC detect error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;DC detect error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg03&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;DC gas gauge under 10%!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg04&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;BIOS version compare error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Model name compare error!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Not support this version of Flash Common Interface!
&lt;span class=&quot;nv&quot;&gt;ErrorMsg11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Show BIOS version string length more &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;xx bytes.
&lt;span class=&quot;nv&quot;&gt;ErrorMsg12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Show model name string length more &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;xx bytes.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Inside the file I found a section that is exactly the same as the configuration file and it is preceded by a string quite suspicious.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings isflashWin.bin &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep &lt;span class=&quot;s2&quot;&gt;&amp;quot;\$_IFLASH&amp;quot;&lt;/span&gt;
5&lt;span class=&quot;nv&quot;&gt;$_IFLASH_DRV_IMG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_BIOSIMG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_INI_IMG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_IFLASH_EC_IMG_&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I think these headers separate sections of the file as they are all 16 characters long. By having a look inside Hexedit I found that there is a padding of 8 bytes between the last character and some famous file magic 
numbers. I&amp;#39;ve done a simple python script (filesplitter) for splitting this kind of files and continue the analysis.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;argparse&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_DRV_IMG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_BIOSIMG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_INI_IMG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;$_IFLASH_EC_IMG_&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argparse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArgumentParser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Split Insyde H2O firmware files.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_argument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;-f&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;--file&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;filename&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;File to be processed.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metavar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parse_args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;makedirs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;magic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/one&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/two&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/three&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/four&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/five&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./filesplitter -f isflashWin.bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;isflashWin/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file *
five:  data
four:  ASCII text, with CRLF line terminators
one:   MS-DOS executable
three: Intel serial flash &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;PCH ROM
two:   MS-DOS executable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Part number four is clearly the configuration file. If you are trying to tweak parameters in platform.ini note that it wont work, but if you modify this part of the binary file it will. It seems that Insyde is now 
using the platform.ini only to point to the update file (isflashWin.bin) and then the utility just parses the configuration from there.
I had no success in running one and two. I&amp;#39;ve tried FreeDOS and Windows 98 in DOS mode which should have support for MZ executables but in the best case I got no output and in the worse some memory address exceptions.
I found that number three is related to a utility called &lt;a href=&quot;http://flashrom.org/Flashrom&quot;&gt;Flashrom&lt;/a&gt; but I don&amp;#39;t have much time to investigate. Maybe some readers can point me in the right direction.
After having a look to five in Hexedit I think it can be a BIOS image although I don&amp;#39;t really know about this topic.&lt;/p&gt;

&lt;p&gt;Although I could not flash my BIOS I could find some little information about this new format and I also found that MZ executable signatures weren&amp;#39;t in the binary analysis tool I use (&lt;a href=&quot;http://binwalk.com/&quot;&gt;binwalk&lt;/a&gt;). 
The latest version of binwalk now looks for MZ executables.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Multiple security flaws in Comtrend router</title>
		<link href="http://antoniovazquezblanco.github.io//2014/05/20/Multiple-security-flaws-in-Comtrend-router.html"/>
		<updated>2014-05-20T00:00:00+02:00</updated>
		<id>http://antoniovazquezblanco.github.io//2014/05/20/Multiple-security-flaws-in-Comtrend-router</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;/images/posts/2014-05-20-Comtrend_C54APM.jpg&quot; alt=&quot;c54apmaccesspoint&quot; title=&quot;Conceptronic C54APM access point...&quot;&gt;&lt;/p&gt;

&lt;p&gt;Last summer I&amp;#39;ve been playing with an old access point I found among my unused devices. Although this is far away from being a top selling device I decided to investigate a bit in order to find security flaws on it.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I&amp;#39;ve downloaded the latest binary firmware for it and analysed it. This along some other information retrieved by the UART port inside it lead to a discovery of security flaws in the web interface.&lt;/p&gt;

&lt;p&gt;Future posts will explain how I was able to interface the UART port and some basis of firmware analisys. I hope you will find them interesting.&lt;/p&gt;

&lt;p&gt;More information can be found in the following links:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/docs/advisories/Advisory_C54APM_Multiple.pdf&quot;&gt;Advisory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1405&quot;&gt;CVE-2014-1405&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1406&quot;&gt;CVE-2014-1406&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1407&quot;&gt;CVE-2014-1407&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1408&quot;&gt;CVE-2014-1408&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101916&quot;&gt;OSVDB 101916&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101917&quot;&gt;OSVDB 101917&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101918&quot;&gt;OSVDB 101918&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101919&quot;&gt;OSVDB 101919&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101920&quot;&gt;OSVDB 101920&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.osvdb.net/show/osvdb/101921&quot;&gt;OSVDB 101921&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
	</entry>
	
	<entry>
		<title>Security flaw in RomPager webserver</title>
		<link href="http://antoniovazquezblanco.github.io//2014/05/18/Security-flaw-in-RomPager-webserver.html"/>
		<updated>2014-05-18T00:00:00+02:00</updated>
		<id>http://antoniovazquezblanco.github.io//2014/05/18/Security-flaw-in-RomPager-webserver</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;/images/posts/2014-05-18-Allegro_software.png&quot; alt=&quot;allegrosoftware&quot; title=&quot;Allegro software&quot;&gt;&lt;/p&gt;

&lt;p&gt;RomPager is a widely used embedded webserver. Playing around with an quite old but very widely used (or at least in Spain) ZyXEL P-660HW-D1 I could find an small bug in this software that leads to XSS and URL redirection.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I&amp;#39;ve reported to &lt;a href=&quot;http://cert.inteco.es/&quot;&gt;INTECO-CERT&lt;/a&gt; and I was told that this was already fixed in newer versions of the software because this had been seen previously in other devices. Although this was already 
discovered it had no CVE identifier so I requested one to MITRE.&lt;/p&gt;

&lt;p&gt;Further information about affected devices and how to exploit the issue can be found in the following links:  &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/docs/advisories/Advisory_RomPagerXSS.pdf&quot;&gt;Advisory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://osvdb.org/show/osvdb/99694&quot;&gt;OSVDB 99694&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://osvdb.org/show/osvdb/99695&quot;&gt;OSVDB 99695&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://cve.mitre.org/cgi-bin/cvename.cgi?name=2013-6786&quot;&gt;CVE 2013-6786&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
	</entry>
	
	<entry>
		<title>Hello world</title>
		<link href="http://antoniovazquezblanco.github.io//2014/04/18/Hello-world.html"/>
		<updated>2014-04-18T00:00:00+02:00</updated>
		<id>http://antoniovazquezblanco.github.io//2014/04/18/Hello-world</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;/images/posts/2014-04-18-Myself.png&quot; alt=&quot;antoniovazquezblanco&quot; title=&quot;Antonio Vázquez Blanco&quot;&gt;&lt;/p&gt;

&lt;p&gt;I&amp;#39;m an engineering undergraduate born in a &lt;a href=&quot;https://www.google.com/maps/place/Chantada&quot;&gt;small town called Chantada&lt;/a&gt;, that likes electronics and computer and if you ask me, I&amp;#39;m specially interested in the security area 
and in robotics.  &lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I would like to use this blog to share some of my experiences and specially the knowledge that I found difficult to locate on the net or that really helped me getting introduced into particular topics like embeded 
device security.  &lt;/p&gt;

&lt;p&gt;I think you will find usefull some of my projects and interests and I hope you can learn from my experience the same way I expect learning from your opinions and comments. I would like to see a lot of feedback and/or 
any questions you think I might be able to solve in my mailbox (&lt;a href=&quot;mailto:antoniovazquezblanco@gmail.com&quot;&gt;antoniovazquezblanco@gmail.com&lt;/a&gt;) or in comments (not implemented yet in this blog...).&lt;/p&gt;
</content>
	</entry>
	
</feed>
